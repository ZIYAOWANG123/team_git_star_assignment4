---
title: "team_git_star_assignment4"
Subtitle: "Analysis report for criminal incidents in Victoria"
author: "ZIYAO WANG (Billy)"
date: "2021/5/15"
output:
  bookdown::html_document2: 
              css: monashreport.css
              includes:
               before_body: header.html
               toc: true
               toc_float: true
  bookdown::pdf_document2: default
keep_md: true    
---

# Introduction



# Research questions:


Section 1 - Table 1

- [ ] Which police region has the greatest number of incidents recorded?
- [ ] How did the trend of incidents recorded in those police regions varied across the years?
- [ ] What is the trend of incidents recorded in North West Metro's local government areas changes over time?

Section 2

- [ ] For each LGA , which offence_subdivision, recorded maximum incidents
- [ ] Which offence_subgroup was most recorded in the previous found offence_subdivision's?
- [ ] What was the trend of each offence_subgroup found over the years?

Section 3

- [ ] For each Suburb/Town, which offence_subdivision, recorded maximum incidents
- [ ] For each Suburb/Town,Which offence_subgroup was most recorded in the previous found offence_subdivision's?

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, eval = TRUE, fig.align = "center", fig.path = "Figures/",message = FALSE, warning = FALSE)
```

```{r loadlibrary, message=FALSE, include=FALSE}
library(tidyverse)
library(readxl)
library(haven)
library(ggplot2)
library(kableExtra)
library(ggResidpanel)
library(bookdown)
library(plotly)
library(here)
library(dplyr)
library(naniar)
library(tidytext)
```

```{r cleandata, include=FALSE}
dat <- read_excel("data/Data_Tables_LGA_Criminal_Incidents_Year_Ending_December_2020.xlsx", sheet=2)

dat <- dat %>% 
  select(c(Year, `Police Region`, `Local Government Area`, `Incidents Recorded`)) 
```


```{r readdata, include=FALSE}
dat1 <- read.csv("data/LGA_Criminal_data2020.csv")
```
# Section 1

Note: The data for section 1 data analysis has excluded the criminal incidents where the geographic location is unknown. For further information on these geographic locations please refer to the Explanatory Notes and Glossary on the [website](https://www.crimestatistics.vic.gov.au/about-the-data/explanatory-notes#Data%20source%20%E2%80%93%20Victoria%20Police).

## Q1 Which police region has the greatest number of incidents recorded?

From the table \@ref(tab:table1), it shows an overview of the total number of incidents recorded for each police region from 2011 to 2020. It indicates that the North West Metro police region has recorded maximum incidents during the period. 

```{r table1, message=FALSE}
dat_tot <- dat1 %>% 
  filter(`Local.Government.Area` == "Total") %>% 
  group_by(`Police.Region`) %>% 
  summarise(Total_Incidents = sum(`Incidents.Recorded`)) %>% 
  arrange(-Total_Incidents)

table1 <- dat_tot %>% 
  knitr::kable(caption = "Number of Incidents Recorded in different Police Region", align = 'c') %>% 
  kable_styling(bootstrap_options = c("striped", "hover","basic"))
table1

```
## Q2 How did the trend of incidents recorded in those police regions varied across the years? 

Figure \@ref(fig:total) presents the movement of the incidents recorded for each police region over time. 

In the four main police regions of Victoria, it illustrates an evident fact that the number of incidents recorded has reached the peak around early 2016, then has a sudden pungle afterward.

The possible reason behind may be that the large decrease on the number of burglary and theft from 2016 to 2017, according to the report from [Victoria crime statistics](https://www.crimestatistics.vic.gov.au/crime-statistics/latest-victorian-crime-data/victim-reports-2).

Additionally, this report states that the number of deception cases is in a continuous increase, which may due to the convenience of technology of e-mail, mobile phones and the internet. Thus, it may highlight some areas for re-enforcement in the future, such as cyber security and private data privacy.

```{r total,fig.cap = "Total number of incidents recorded in each police region", fig.height=8, fig.align='center',fig.width=10}
dat_var <- dat1 %>% 
  filter(`Local.Government.Area` == "Total") %>% 
  group_by(Year, `Police.Region`) %>% 
  summarise(Total_Incidents = sum(`Incidents.Recorded`))

figure1 <- ggplot(dat_var, aes(x= Year,
                               y = Total_Incidents,   
                               color = `Police.Region`))+
  geom_line() +
  geom_point() +
  scale_x_continuous(breaks=seq(2011,2020,2)) +
  theme_bw()+
  facet_wrap(~ `Police.Region`, scales = "free",ncol=2)+
  scale_fill_brewer(palette = "Dark2")
ggplotly(figure1)
```

## Q3 What is the trend of incidents recorded in North West Metro's local government areas changes over time?

The observation from table \@ref(tab:table1) triggers an interest for further investigation on the North West Metro police region. 

Since it is the most incidents recorded region, constructing a figure \@ref(fig:north) to observe the change of the number of incidents recorded in different local government areas may provide some insights. 

The figures suggest that there is a tendency that the number of incidents recorded is increasing since 2019. This can provide some suggestions to the government in terms of adjusting the public safety policy and assigning the police resources. 

Yet, few exceptions such as Hobsons Bay, Moonee Valley and Banyule, the reason maybe they are not the major resident area hance fewer criminal activities occurrence.


```{r north, fig.cap = "Crimial activity trend in different suburbs from North West Metro", fig.align='center', fig.height=11,fig.width=10}
dat_North <- dat1 %>% 
  filter(Police.Region == "1 North West Metro") %>% 
  select(-X)

trend <- dat_North %>% 
  group_by(Local.Government.Area, Year) %>% 
  summarise(Total_Incidents = sum(`Incidents.Recorded`)) %>% 
  arrange(-Total_Incidents) %>% 
  filter(Local.Government.Area %in% c("Melbourne", 
                                      "Hume", 
                                      "Brimbank", 
                                      "Wyndham", 
                                      "Whittlesea", 
                                      "Moreland",
                                      "Banyule",
                                      "Darebin",
                                      "Hobsons Bay",
                                      "Maribyrnong",
                                      "Melton",
                                      "Moonee Valley",
                                      "Nillumbik",
                                      "Yarra"))

figure2 <- ggplot(trend, aes(x= Year, 
                             y = Total_Incidents,
                             color = Local.Government.Area))+
  geom_line()+
  geom_point() +
  scale_x_continuous(breaks=seq(2011,2020,2)) +
  facet_wrap(~ `Local.Government.Area`, scales = "free",ncol=2)+
  scale_fill_brewer(palette = "Dark2")+
  theme_bw()
ggplotly(figure2)

```


# Section 2

## For each LGA , which offence_subdivision, recorded maximum incidents
```{r read-data, include=FALSE}
criminaldata <- read_excel("data/Data_Tables_LGA_Criminal_Incidents_Year_Ending_December_2020.xlsx", sheet = 4)
```
```{r datacleaning, include=FALSE}
criminaluse <- criminaldata %>% 
  select(Year,
         `Local Government Area`,
         `Offence Subdivision`,
         `Incidents Recorded`)
```

```{r vis1, fig.width=9,fig.height=12,fig.cap="No .of Imcidents of top offennce in each LGA"}
  criminalfinal<- criminaluse %>% 
    mutate(lgth = str_length(`Offence Subdivision`)) %>% 
  mutate(`Offence Subdivision` = substr(`Offence Subdivision`,start = 5,stop = lgth)) %>% 
  mutate(`Offence Subdivision` = str_replace(`Offence Subdivision`,"r crimes against the person","Other crimes against the person")) %>% 
  group_by(`Local Government Area`, `Offence Subdivision` ) %>% 
    summarise(incidents = sum(`Incidents Recorded`)) 

data<- criminalfinal %>% arrange(desc(incidents)) %>%
slice(1) %>% 
ggplot(aes(y=reorder(`Local Government Area`,incidents),
       x=incidents,
       fill = `Offence Subdivision`)) +
  geom_col()+
  geom_text(aes(label = incidents)) +
  xlab("No. of Incidents") +
  ylab("Local Government Area") +
  theme(axis.text.x = element_blank()) 
 ggplotly(data)
```
The figure \@ref(fig:vis1)  shows:

- Theft was the most common crime in each region.

- Melbourne in particular recording round 90,900 burglaries in the past five years,far more than any other region.

```{r vis2, fig.width=10, fig.cap="Trend of each Offence_subdivision from year 2011-2020"}
  criminalfinal2<- criminaluse %>% 
   mutate(lgth = str_length(`Offence Subdivision`)) %>% 
  mutate(`Offence Subdivision` = substr(`Offence Subdivision`,start = 5,stop = lgth)) %>% 
  mutate(`Offence Subdivision` = str_replace(`Offence Subdivision`,"r crimes against the person","Other crimes against the person")) %>% 
  group_by(Year,
           `Offence Subdivision` ) %>% 
    summarise(incidents = sum(`Incidents Recorded`)) %>% 
ggplot(aes(x=as.numeric(Year),
       y=incidents,
       color = `Offence Subdivision` )) +
  geom_line()+
  geom_point() +
  scale_x_continuous() +
  ylab("No. of Incidents") +
  scale_x_continuous(breaks=seq(2011,2020,2)) +
  xlab("Year") 
 ggplotly(criminalfinal2) %>% 
   hide_legend()
```
The figure \@ref(fig:vis2)  shows

- Theft cases have far exceeded other types of crime in the past five years, especially reaching a peak (about 156,000) in 2016, but the number has declined in the past two years.

- Burlary/Break and Enter (about 38,000) and Assault and Related Offence (about 37,000) rank second and third, respectively.




## Which offence_subgroup was most recorded in the previous found offence_subdivisionâ€™s?
```{r datacleaning2, include=FALSE}
criminaluse2 <- criminaldata %>%
  select(Year,
         `Offence Subgroup`,
         `Offence Subdivision`,
         `Incidents Recorded`) %>%
  filter(`Offence Subdivision` == "B40 Theft")
```
```{r vis3, fig.width=9,fig.cap="Incidents in each Offence_subgroup of most recorded Offence_subdivision"}
    criminalfinal3<- criminaluse2 %>%
  group_by(Year, `Offence Subgroup`) %>%
    summarise(incidents = sum(`Incidents Recorded`)) %>%
ggplot(aes(Year,
       incidents,
       fill = `Offence Subgroup` )) +
  geom_col(position="dodge")+
   ggtitle("Percentage of each offence_subgroup in the previous found offence_subdivision's")
 ggplotly(criminalfinal3)
```


The figure \@ref(fig:vis3) shows

- Among thefts, steal from a motor vehicle has the largest number during the last five years. In 2016, about 63,000 steal from a motor vehicle occurred, but the number of thefts has decreased in the past two years.

- Other Theft is second(around40000), and other offence_subgroup make up only a small fraction.



##  What was the trend of each offence_subgroup over the years?
```{r datacleaning3, include=FALSE}
criminaluse3 <- criminaldata %>% 
  select(Year,
         `Offence Subgroup`,
         `Incidents Recorded`)
```
```{r vis4, fig.width=10, fig.cap="Trend ofIncidents of each offence_subgroup"}
  criminalfinal4<- criminaluse3 %>% 
  mutate(lgth = str_length(`Offence Subgroup`)) %>% 
  mutate(`Offence Subgroup` = substr(`Offence Subgroup`,start = 5,stop = lgth)) %>% 
  mutate(`Offence Subgroup` = str_replace(`Offence Subgroup`,"r crimes against the person","Other crimes against the person")) %>% 
  group_by(Year, `Offence Subgroup`) %>% 
    summarise(incidents = sum(`Incidents Recorded`)) %>% 
  arrange(`Offence Subgroup`,desc(incidents)) %>% 
    ggplot(aes(Year,
       incidents,
       color = `Offence Subgroup`)) +
  geom_line()+
  scale_x_continuous(breaks=seq(2011,2020,2))+
  geom_point() +
  ylab("No. of Imcidents")
 ggplotly(criminalfinal4) %>% 
   hide_legend()
```
The figure \@ref(fig:vis4)  shows

- Most have seen a decline in crime over the past year, and almost all have seen a small spike in 2016.

- Steal from a motor vehicle in the category of theft has been in the first place in the past five years, with about 50,000 cases occurring every year, far exceeding other offence_subgroups.

- Other Theft is in second place (about 39,000 per year) and Criminal Damage is third (about 35,000 per year). However, the gap between these two types of crimes and steal from a notor vehicle has gradually widened since 2013.

## Conclusion:

- In each LGA, theft occurs most frequently in offence_subdivision and the incidence of thefts is far greater than other types of offence_subdivision.

- In the theft offence_subdivision, the vast majority are steal from a motor vehicle and other Theft.

- Of all offence_subgroups, Steal from a motor vehicle in all offence_subgroups, Other Theft and Criminal Damage were the top three, but the vast majority of offence_subgroups were up in 2016, but have declined in the last two years.





```{r read-file,include=FALSE}
data3 <- read_excel(here::here("data/Data_Tables_LGA_Criminal_Incidents_Year_Ending_December_2020.xlsx"),sheet = 4)
```

```{r clean,include=FALSE}
miss_var_summary(data3)
data3 <- data3 %>% 
  rename(Month = `Year ending`,
         LGA = `Local Government Area`,
         Suburb = `Suburb/Town Name`,
         Offence_Division = `Offence Division`,
         Offence_Subdivision = `Offence Subdivision`,
         Offence_Subgroup = `Offence Subgroup`,
         Incidents_Recorded = `Incidents Recorded`)
```

# Section 3 

## What are the top 10 Suburbs wth maximum no of incidents so far?

```{r Q1-table,echo=FALSE}
data3 %>% 
  group_by(Suburb) %>%
  summarise(Total_Incidents = sum(Incidents_Recorded)) %>% 
  slice_max(Total_Incidents,n = 10) %>% 
  kable(caption = "Suburbs with maximum incidents over the years") %>% 
  kable_styling(bootstrap_options = c("striped","hover","basic"))
```

The table \@ref(tab:Q1-table) clearly states that:

* **Melbourne** had maximum no of incidents with more than 1.5 lakh over the years 
* Other suburbs were 60K incidents in total. 

## What are the top 10 Suburb's recorded with most number of incidents in each Year ?

```{r Q1,echo=FALSE,fig.width=8,fig.height=15,fig.cap="Top 10 Suburb with most incidents recorded"}
data3 %>% 
  group_by(Year,Suburb) %>%
  summarise(Total_Incidents = sum(Incidents_Recorded)) %>% 
  arrange(Year,desc(Total_Incidents)) %>% 
  slice_max(Total_Incidents,n = 10) %>% 
  mutate(Suburb1 = reorder_within(Suburb,Total_Incidents,Year)) %>% 
  ggplot(aes(x=Total_Incidents ,
             y=Suburb1,
             fill = Suburb)) +
  geom_col() +
  geom_text(aes(label = Total_Incidents)) +
  scale_y_reordered() +
  ylab("Suburb") +
  xlab("No. of Incidents") +
  ggtitle("Top 10 Suburb with most incidents recorded in each Years") +
  facet_wrap(~Year,ncol = 1, scales = "free")
```
The Figure \@ref(fig:Q1) depicts that:

*  **Melbourne** not only had overall maximum incidents, but also had the maxiimum crime in each year.
*  It had least no of crimes in year **2015**.
*  Suprisiingly, **Melbourne** saw a massive fall of 10K in crime no. from 2019-2020, mqybe due to lockdown restrictions imposed  during COVID-19.

## What were the top 10 Offence's in each year ?

```{r Q2,echo=FALSE,fig.width=12,fig.height=15,fig.cap="Top 10 Offences recorded"}
data3 %>%
  mutate(lgth = str_length(Offence_Subdivision)) %>% 
  mutate(Offence_Subdivision = substr(Offence_Subdivision,start = 5,stop = lgth)) %>% 
  mutate(Offence_Subdivision = str_replace(Offence_Subdivision,"r crimes against the person","Other crimes against the person")) %>% 
  group_by(Year,Offence_Subdivision) %>% 
  summarise(Tot_incidents = sum(Incidents_Recorded)) %>% 
  arrange(Year,desc(Tot_incidents)) %>%
  slice_max(Tot_incidents,n = 10) %>% 
  mutate(Offence1 = reorder_within(Offence_Subdivision,Tot_incidents,Year)) %>% 
    ggplot(aes(y= Offence1,
         x= Tot_incidents,
         fill = Offence_Subdivision)) +
  geom_col() +
  geom_text(aes(label = Tot_incidents)) +
  scale_y_reordered() +
  ylab("Type of Offece") +
  xlab("No of Incidents") +
  facet_wrap(~Year,ncol = 1,scales = "free")
```
The Figure \@ref(fig:Q2) showcases that:

*  **Theft** was the most occurred crime across all the years.
*  **Burglary/Break and enter** type of offence decreased over the years.

## What are the top 2 Offences for the most affected Suburb's found in figure \@ref(fig:Q1)?

```{r Q3,echo=FALSE,fig.width=10,fig.height=4,fig.cap="Top 10 Offfences Suburrb wise"}
Suburb_imp <- data3 %>% 
  group_by(Year,Suburb) %>%
  summarise(Total_Incidents = sum(Incidents_Recorded)) %>% 
  arrange(Year,desc(Total_Incidents)) %>% 
  slice_max(Total_Incidents,n = 10) 


Q3graph <- data3 %>% 
  mutate(lgth = str_length(Offence_Subdivision)) %>% 
  mutate(Offence_Subdivision = substr(Offence_Subdivision,start = 5,stop = lgth)) %>% 
  mutate(Offence_Subdivision = str_replace(Offence_Subdivision,"r crimes against the person","Other crimes against the person")) %>% 
  filter(Suburb %in% unique(Suburb_imp$Suburb)) %>% 
  group_by(Suburb,Offence_Subdivision) %>% 
  summarise(Tot_incidents = sum(Incidents_Recorded)) %>% 
  slice_max(Tot_incidents,n = 2) %>% 
  arrange(-Tot_incidents) %>% 
  #mutate(offence1 = reorder_within(Offence_Subdivision,Tot_incidents,Suburb)) %>% 
  ggplot(aes(y= Suburb,
             x =Tot_incidents,
             fill = Offence_Subdivision)) +
  geom_col() 
  ggplotly(Q3graph)
```

The Figure \@ref(fig:Q3) is clearly in coordination with figure \@ref(fig:Q2) as we can see that **Theft** is most occurred crime across the affected Suburbs too

## What is the trend of top 2 offences in each year w.r.t most affected Suburb?

```{r Q4,echo=FALSE,fig.width=10,fig.height=10,fig.cap="Trend of Top 2 Offences in each year w.r.t Suburb" }
Q4graoh <- data3 %>% 
  mutate(lgth = str_length(Offence_Subdivision)) %>% 
  mutate(Offence_Subdivision = substr(Offence_Subdivision,start = 5,stop = lgth)) %>% 
  mutate(Offence_Subdivision = str_replace(Offence_Subdivision,"r crimes against the person","Other crimes against the person")) %>% 
  filter(Suburb %in% unique(Suburb_imp$Suburb)) %>% 
  group_by(Year,Suburb,Offence_Subdivision) %>% 
  summarise(Tot_incidents = sum(Incidents_Recorded)) %>% 
  slice_max(Tot_incidents,n = 2) %>% 
  ggplot(aes(x= as.numeric(Year),
             y =Tot_incidents,
             color = Offence_Subdivision)) +
  geom_line() +
  geom_point() +
  scale_x_continuous(breaks=seq(2011,2020,2)) +
  xlab("Year") +
  ylab("Total_incidents") +
  facet_wrap(~Suburb)
ggplotly(Q4graoh)

```


The Figure \@ref(fig:Q4) depicts that:

*  Crime rate of the 2 most occured offences im the affected Suburbs were pretty much steafy along the years.
*  Im **Melbourne**.
   *  **Disorderly and offensive conduct** crime went off radar after 2014.
   *  **Breachers of order** were only seen from years 2015-2019.
   *  **Miscellaneous offence** came into action in year 2020.
   

