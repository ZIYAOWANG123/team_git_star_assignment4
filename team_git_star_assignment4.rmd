---
title: "team_git_star_assignment4"
author: "ZIYAO WANG (Billy)"
date: "2021/5/15"
output: html_document
---

Research questions:

Section 1 - Table 1

- [ ] For each LGA , which police region recorded maximum incidents?
- [ ] How did the trend of incidents recorded in those police regions varied across the years.

Section 2

- [ ]  For each LGA , which offence_subdivision, recorded maximum incidents
- [ ] For each LGA,Which offence_subgroup was most recorded in the previous found offence_subdivision's?
- [ ] What was the trend of each offence_subgroup found over the years?

Section 3

- [ ]  For each Suburb/Town, which offence_subdivision, recorded maximum incidents
- [ ] For each Suburb/Town,Which offence_subgroup was most recorded in the previous found offence_subdivision's?

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval = TRUE, fig.align = "center", fig.path = "Figures/",message = FALSE, warning = FALSE)
```



```{r loadlibrary, message=FALSE}
library(tidyverse)
library(readxl)
library(haven)
library(ggplot2)
library(kableExtra)
library(ggResidpanel)
library(bookdown)
```

dat <- read_excel("data/Data_Tables_LGA_Criminal_Incidents_Year_Ending_December_2020.xlsx", sheet=2)

dat <- dat %>% 
  select(c(Year, `Police Region`, `Local Government Area`, `Incidents Recorded`)) 


```{r readdata}
dat1 <- read.csv("data/LGA_Criminal_data2020.csv")
```

2011-2020 the total numeber of incidents recorded for each police region.
```{r table1, message=FALSE}
dat_tot <- dat1 %>% 
  filter(`Local.Government.Area` == "Total") %>% 
  group_by(`Police.Region`) %>% 
  summarise(Total_Incidents = sum(`Incidents.Recorded`)) %>% 
  arrange(-Total_Incidents)

table1 <- dat_tot %>% 
  knitr::kable(caption = "Number of Incidents Recorded in different Police Region", align = 'c') %>% 
  kable_styling(bootstrap_options = c("striped", "hover"))
table1

```
To obtain the movement of the incidents recorded for each police region over the years.

```{r figure1, fig.height=8, fig.align='center'}
dat_var <- dat1 %>% 
  filter(`Local.Government.Area` == "Total") %>% 
  group_by(Year, `Police.Region`) %>% 
  summarise(Total_Incidents = sum(`Incidents.Recorded`))

figure1 <- ggplot(dat_var, aes(x= Year, y = Total_Incidents),
       color = `Police.Region`)+
  geom_line()+
  theme_bw()+
  facet_wrap(~ `Police.Region`, scales = "free",ncol=2)+
  scale_fill_brewer(palette = "Dark2")
figure1
```

In the most incidents recorded police region "1 North West Metro", investigating through observing the number of incident recorded in different local government areas over time.

```{r figure2, fig.align='center', fig.height=11}
dat_North <- dat1 %>% 
  filter(Police.Region == "1 North West Metro") %>% 
  select(-X)

trend <- dat_North %>% 
  group_by(Local.Government.Area, Year) %>% 
  summarise(Total_Incidents = sum(`Incidents.Recorded`)) %>% 
  arrange(-Total_Incidents) %>% 
  filter(Local.Government.Area %in% c("Melbourne", 
                                      "Hume", 
                                      "Brimbank", 
                                      "Wyndham", 
                                      "Whittlesea", 
                                      "Moreland",
                                      "Banyule",
                                      "Darebin",
                                      "Hobsons Bay",
                                      "Maribyrnong",
                                      "Melton",
                                      "Moonee Valley",
                                      "Nillumbik",
                                      "Yarra"))

figure2 <- ggplot(trend, aes(x= Year, y = Total_Incidents))+
  geom_line()+
  facet_wrap(~ `Local.Government.Area`, scales = "free",ncol=2)+
  scale_fill_brewer(palette = "Dark2")
figure2

```





